function epsilon = pa_molarextcoef_hemo(varargin)
% EPSILON = PA_MOLAREXTCOEF_HEMO
%
% Molar extinction coefficients
%
% epsilon:
% - lambda (nm)
% - Hb02  [1/(cm*M)]
% - Hb [1/(cm*M)]
%
% PA_MOLAREXTCOEF(...,'PARAM1',val1) specifies optional
% name/value pairs. Parameters are:
%	'display'	- display graph. Choices are:
%					0	- no graph (default)
%					>0	- graph
%
% Source: ???
%
% See also: PA_MBLL

% Optional display arguments
disp         = pa_keyval('display',varargin);
if isempty(disp)
% 	disp	= true;
	disp	= false;
end

epsilon = [650	0.3869	3.7351 ...
	;651	0.3793	3.7039 ...
	;652	0.3722	3.6727 ...
	;653	0.3659	3.6414 ...
	;654	0.3601	3.6126 ...
	;655	0.3545	3.5841 ...
	;656	0.3495	3.5555 ...
	;657	0.3451	3.5269 ...
	;658	0.341	3.4982 ...
	;659	0.3376	3.4695 ...
	;660	0.3346	3.4408 ...
	;661	0.3318	3.4062 ...
	;662	0.3294	3.3717 ...
	;663	0.3276	3.3371 ...
	;664	0.326	3.299 ...
	;665	0.3245	3.2582 ...
	;666	0.3234	3.2174 ...
	;667	0.3227	3.1762 ...
	;668	0.322	3.1327 ...
	;669	0.3216	3.0891 ...
	;670	0.3213	3.0455 ...
	;671	0.3212	2.9993 ...
	;672	0.3212	2.9519 ...
	;673	0.3214	2.9045 ...
	;674	0.3214	2.8569 ...
	;675	0.3211	2.8087 ...
	;676	0.3208	2.7606 ...
	;677	0.3206	2.7124 ...
	;678	0.3205	2.6652 ...
	;679	0.3201	2.6183 ...
	;680	0.3194	2.5713 ...
	;681	0.3186	2.5248 ...
	;682	0.3181	2.4788 ...
	;683	0.3173	2.4329 ...
	;684	0.3163	2.387 ...
	;685	0.3157	2.3436 ...
	;686	0.3151	2.3004 ...
	;687	0.314	2.2572 ...
	;688	0.3135	2.2162 ...
	;689	0.3126	2.1772 ...
	;690	0.3123	2.1382 ...
	;691	0.3122	2.0997 ...
	;692	0.3122	2.0656 ...
	;693	0.3123	2.0315 ...
	;694	0.3125	1.9974 ...
	;695	0.313	1.9665 ...
	;696	0.314	1.937 ...
	;697	0.3148	1.9076 ...
	;698	0.3164	1.8791 ...
	;699	0.3181	1.853 ...
	;700	0.3199	1.827 ...
	;701	0.3219	1.801 ...
	;702	0.3243	1.7777 ...
	;703	0.3269	1.7548 ...
	;704	0.3296	1.7319 ...
	;705	0.3323	1.7099 ...
	;706	0.3352	1.6887 ...
	;707	0.3386	1.6675 ...
	;708	0.3418	1.6464 ...
	;709	0.345	1.6267 ...
	;710	0.3485	1.607 ...
	;711	0.3524	1.5873 ...
	;712	0.3564	1.5677 ...
	;713	0.3602	1.5481 ...
	;714	0.3639	1.5285 ...
	;715	0.368	1.5093 ...
	;716	0.3724	1.4907 ...
	;717	0.3765	1.4721 ...
	;718	0.3807	1.4535 ...
	;719	0.3854	1.4365 ...
	;720	0.3899	1.4197 ...
	;721	0.3943	1.4029 ...
	;722	0.3988	1.3875 ...
	;723	0.4035	1.3733 ...
	;724	0.4083	1.3592 ...
	;725	0.4133	1.3456 ...
	;726	0.4181	1.3352 ...
	;727	0.423	1.3249 ...
	;728	0.4281	1.3146 ...
	;729	0.4332	1.3081 ...
	;730	0.4383	1.3029 ...
	;731	0.4435	1.2976 ...
	;732	0.4488	1.2946 ...
	;733	0.454	1.295 ...
	;734	0.4593	1.2953 ...
	;735	0.4646	1.2959 ...
	;736	0.47	1.3028 ...
	;737	0.4754	1.3096 ...
	;738	0.4811	1.3164 ...
	;739	0.4863	1.3277 ...
	;740	0.492	1.3411 ...
	;741	0.4976	1.3545 ...
	;742	0.5032	1.3697 ...
	;743	0.5089	1.3887 ...
	;744	0.5147	1.4078 ...
	;745	0.5203	1.4268 ...
	;746	0.5259	1.4501 ...
	;747	0.5317	1.4736 ...
	;748	0.5376	1.4971 ...
	;749	0.5436	1.5212 ...
	;750	0.5495	1.5458 ...
	;751	0.5554	1.5703 ...
	;752	0.5613	1.5938 ...
	;753	0.5672	1.6142 ...
	;754	0.5731	1.6346 ...
	;755	0.5791	1.6549 ...
	;756	0.5856	1.6646 ...
	;757	0.5912	1.6733 ...
	;758	0.5974	1.682 ...
	;759	0.6031	1.6816 ...
	;760	0.6096	1.6745 ...
	;761	0.6157	1.6674 ...
	;762	0.6219	1.6566 ...
	;763	0.6283	1.6343 ...
	;764	0.6345	1.6121 ...
	;765	0.6407	1.5898 ...
	;766	0.6469	1.5582 ...
	;767	0.6535	1.5259 ...
	;768	0.6596	1.4935 ...
	;769	0.6658	1.459 ...
	;770	0.672	1.4229 ...
	;771	0.6785	1.3869 ...
	;772	0.6849	1.3513 ...
	;773	0.6911	1.3169 ...
	;774	0.6974	1.2825 ...
	;775	0.7038	1.2481 ...
	;776	0.7101	1.2175 ...
	;777	0.7166	1.187 ...
	;778	0.7229	1.1566 ...
	;779	0.7297	1.1298 ...
	;780	0.736	1.105 ...
	;781	0.7422	1.0803 ...
	;782	0.7485	1.0571 ...
	;783	0.7549	1.0372 ...
	;784	0.7613	1.0173 ...
	;785	0.7681	0.9975 ...
	;786	0.7743	0.9822 ...
	;787	0.7808	0.9668 ...
	;788	0.7874	0.9515 ...
	;789	0.7941	0.9385 ...
	;790	0.8005	0.9264 ...
	;791	0.807	0.9143 ...
	;792	0.8134	0.9034 ...
	;793	0.8197	0.8939 ...
	;794	0.8264	0.8844 ...
	;795	0.833	0.8752 ...
	;796	0.8392	0.8676 ...
	;797	0.8458	0.86 ...
	;798	0.8524	0.8524 ...
	;799	0.8588	0.8461 ...
	;800	0.8653	0.8399 ...
	;801	0.8716	0.8338 ...
	;802	0.878	0.8285 ...
	;803	0.8845	0.8237 ...
	;804	0.8909	0.819 ...
	;805	0.8973	0.8146 ...
	;806	0.9038	0.8111 ...
	;807	0.9102	0.8075 ...
	;808	0.9164	0.804 ...
	;809	0.9227	0.8014 ...
	;810	0.9291	0.7987 ...
	;811	0.9354	0.7961 ...
	;812	0.9416	0.7941 ...
	;813	0.9478	0.7922 ...
	;814	0.9539	0.7904 ...
	;815	0.9603	0.7888 ...
	;816	0.9666	0.7874 ...
	;817	0.9728	0.7861 ...
	;818	0.9789	0.7849 ...
	;819	0.9848	0.7842 ...
	;820	0.9911	0.7834 ...
	;821	0.9973	0.7827 ...
	;822	1.0032	0.7822 ...
	;823	1.0091	0.7817 ...
	;824	1.0153	0.7812 ...
	;825	1.0211	0.7809 ...
	;826	1.0273	0.7808 ...
	;827	1.0333	0.7806 ...
	;828	1.0393	0.7805 ...
	;829	1.0449	0.7804 ...
	;830	1.0507	0.7804 ...
	;831	1.0564	0.7804 ...
	;832	1.0621	0.7804 ...
	;833	1.068	0.7804 ...
	;834	1.0739	0.7805 ...
	;835	1.0797	0.7805 ...
	;836	1.0851	0.7806 ...
	;837	1.0907	0.7807 ...
	;838	1.0962	0.7809 ...
	;839	1.1018	0.7812 ...
	;840	1.1072	0.7815 ...
	;841	1.1128	0.7817 ...
	;842	1.1182	0.782 ...
	;843	1.1233	0.7823 ...
	;844	1.1286	0.7827 ...
	;845	1.1339	0.7833 ...
	;846	1.1391	0.7839 ...
	;847	1.1442	0.7845 ...
	;848	1.1494	0.785 ...
	;849	1.1547	0.7856 ...
	;850	1.1596	0.7861 ...
	;851	1.1645	0.7871 ...
	;852	1.1694	0.788 ...
	;853	1.1742	0.789 ...
	;854	1.179	0.7901 ...
	;855	1.1842	0.7912 ...
	;856	1.1885	0.7923 ...
	;857	1.1934	0.7935 ...
	;858	1.198	0.7949 ...
	;859	1.2026	0.7963 ...
	;860	1.2071	0.7977 ...
	;861	1.2114	0.7993 ...
	;862	1.2156	0.8009 ...
	;863	1.22	0.8025 ...
	;864	1.2245	0.8044 ...
	;865	1.2286	0.8063 ...
	;866	1.2325	0.8082 ...
	;867	1.2367	0.8102 ...
	;868	1.2407	0.8122 ...
	;869	1.2449	0.8143 ...
	;870	1.249	0.8166 ...
	;871	1.2529	0.8189 ...
	;872	1.2565	0.8123 ...
	;873	1.2601	0.8237 ...
	;874	1.2641	0.8261 ...
	;875	1.2678	0.8285 ...
	;876	1.271	0.831 ...
	;877	1.2746	0.8336 ...
	;878	1.2781	0.8361 ...
	;879	1.2814	0.8387 ...
	;880	1.2846	0.8412 ...
	;881	1.2878	0.8438 ...
	;882	1.2907	0.8463 ...
	;883	1.2938	0.8489 ...
	;884	1.2971	0.8561 ...
	;885	1.3	0.8542 ...
	;886	1.3027	0.8568 ...
	;887	1.3058	0.8594 ...
	;888	1.3084	0.862 ...
	;889	1.3108	0.8645 ...
	;890	1.3137	0.867 ...
	;891	1.3165	0.8694 ...
	;892	1.3189	0.8718 ...
	;893	1.321	0.8742 ...
	;894	1.3235	0.8765 ...
	;895	1.3262	0.8787 ...
	;896	1.3283	0.8807 ...
	;897	1.3304	0.8827 ...
	;898	1.3323	0.8846 ...
	;899	1.3341	0.8863 ...
	;900	1.3365	0.888];

epsilon(:,2:3) = epsilon(:,2:3)*1000;

if disp
	close all
	plot(epsilon(:,1),epsilon(:,2),'r-','LineWidth',2)
	hold on
	plot(epsilon(:,1),epsilon(:,3),'b-','LineWidth',2)
	
	axis square;							% publication-quality
	box off;								% publication-quality
	set(gca,'TickDir','out','TickLength',[0.005 0.025],...
		'XTick',650:50:900,'YTick',500:500:3500,...
		'FontSize',15,'FontAngle','Italic','FontName','Helvetica'); % publication-quality
	xlabel('Wavelength (nm)','FontSize',15);		% always provide an label on the x-axis
	ylabel('Molar extinction coefficient  \epsilon (cm^{-1}M^{-1})','FontSize',15);	% and on the y-axis
	axis([600 950 200 4000]);						% set axis limits, this can be maximally between -90 and +90 deg
	title('Absorption spectra of hemoglobin'); % Provide all necessary information
	legend('oxyhemoglobin','deoxyhemoglobin');
	pa_datadir;
	print('-depsc','-painters',mfilename);
end